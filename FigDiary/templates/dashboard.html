{% extends "base.html" %}
{% block title %}Your Dashboard{% endblock %}

{% block content %}
  <h2>Welcome, {{ username }}!</h2>

  <form method="post" action="/dashboard">
    <input type="text" name="search" placeholder="Search entries..." />
    <button type="submit">Search</button>
  </form>

  <form method="post" action="/new-entry" style="margin-top: 2em;">
    <textarea name="new-entry" rows="4" cols="50" placeholder="Write something..."></textarea><br>
    <input type="text" name="tags" placeholder="Tags (comma separated)" />
    <br>
    <button type="submit">Add Entry</button>
  </form>

  <ul style="list-style: none; padding: 0;">
    {% for entry in entries %}
      <li style="border: 1px solid #ccc; margin: 1em 0; padding: 1em; border-radius: 5px;">
        <p><strong>{{ entry.timestamp }}</strong></p>
        <p>{{ entry.text }}</p>

        {% if entry.tags %}
          <p>
            {% for tag in entry.tags %}
              <a href="/dashboard?tag={{ tag }}" class="button">#{{ tag }}</a>
            {% endfor %}
          </p>
        {% endif %}

        <form action="/edit-entry/{{ loop.index0 }}" method="get" style="display: inline;">
          <button type="submit">Edit</button>
        </form>

        <form action="/delete-entry" method="post" style="display: inline;">
          <input type="hidden" name="entry-id" value="{{ loop.index0 }}" />
          <button type="submit">Delete</button>
        </form>
      </li>
    {% endfor %}
  </ul>

  <p><a href="/logout" class="button">Logout</a></p>
{% endblock %}
